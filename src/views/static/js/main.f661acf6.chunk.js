(this["webpackJsonpchatmise-react-frontend"]=this["webpackJsonpchatmise-react-frontend"]||[]).push([[0],{449:function(e,t,n){},475:function(e,t,n){"use strict";n.r(t);var s=n(2),a=n.n(s),r=n(18),i=n.n(r),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,476)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),s(e),a(e),r(e),i(e)}))},c=n(9),l=n(10),u=n(52),h=n(12),g=n(11),d=(n(159),n(1)),p=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this)).textInput=a.a.createRef(),s.messageView=a.a.createRef(),s.oldProps={},s}return Object(l.a)(n,[{key:"handleNewMessage",value:function(){var e=this,t=function(){e.textInput.current.focus();var t={text:e.textInput.current.value,sender:e.props.username,time:(new Date).getTime()};e.props.sendAndDisplayMessage(t),e.textInput.current.value="",e.textInput.current.placeholder="type a message here"};""!==e.textInput.current.value?t():e.textInput.current.placeholder="that was an empty message :("}},{key:"enterKeyEvent",value:function(e){13==e.keyCode&&(this.handleNewMessage(),e.preventDefault())}},{key:"componentDidMount",value:function(){this.oldProps=this.props.data,this.messageView.current.lastChild.scrollIntoView(),this.textInput.current.focus()}},{key:"componentDidUpdate",value:function(){this.props.data!==this.oldProps&&this.props.data[0]===this.oldProps[0]?(console.log("it worked!"),this.oldProps=this.props.data,window.screen.width>760?this.messageView.current.lastChild.scrollIntoView({behavior:"smooth"}):this.messageView.current.lastChild.scrollIntoView()):this.messageView.current.lastChild.scrollIntoView()}},{key:"render",value:function(){var e=this;function t(e){var t,n,s;return(e=new Date(e)).getHours()>12?(t="PM",n=e.getHours()-12):(t="AM",0===(n=e.getHours())&&(n=12)),s=e.getMinutes()<=9?"0":"",e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+n+":"+s+e.getMinutes()+" "+t}var n=this.props.data.map((function(n,s){var a=n.sender,r={color:"#52fb9e"};return n.sender===e.props.username&&(a="you",r={color:"#63caec"}),Object(d.jsxs)("div",{className:"individualMessage",style:r,children:[Object(d.jsxs)("div",{className:"info",children:[Object(d.jsx)("span",{className:"sender",children:a+" - "}),Object(d.jsx)("span",{className:"time",children:"  "+t(n.time)})]}),n.text]},s)}));return Object(d.jsxs)("div",{className:"TextsUi",style:this.props.style,children:[Object(d.jsxs)("div",{className:"messagesView",ref:this.messageView,children:[n,Object(d.jsx)("div",{ref:this.fix})]}),Object(d.jsxs)("div",{className:"messageInputs",children:[Object(d.jsx)("textarea",{onFocus:function(){e.messageView.current.lastChild.scrollIntoView()},maxLength:"170",ref:this.textInput,onKeyDown:function(t){e.enterKeyEvent(t)},placeholder:"type a message here"}),Object(d.jsx)("button",{onClick:function(){e.handleNewMessage()},children:"Send"})]})]})}}]),n}(a.a.Component),b=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(){return Object(c.a)(this,n),t.call(this)}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props.data.map((function(t,n){return Object(d.jsx)("div",{className:"individualChat",onClick:function(){e.props.changeCurrentChat(n)},children:t},n)}));return Object(d.jsxs)("div",{className:"ChatMenu",style:this.props.style,children:[Object(d.jsxs)("div",{className:"topBar",children:[Object(d.jsx)("a",{className:"exitButton",onClick:function(){return e.props.toggleChatMenu()}}),"Chats"]}),Object(d.jsx)("div",{className:"chats",children:t})]})}}]),n}(a.a.Component),y=n.p+"static/media/exit.49f87151.svg",m=n.p+"static/media/hamburger.ede0bbc5.svg",j=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).style={content:"url(".concat(m,")")},e}return Object(l.a)(n,[{key:"conditionalRender",value:function(){"block"===this.props.hamburgerMenuStyle.display?this.style={content:"url(".concat(y,")")}:this.style={content:"url(".concat(m,")")}}},{key:"render",value:function(){var e=this;return this.conditionalRender(),Object(d.jsxs)("div",{className:"TopBar",style:this.props.style,children:[Object(d.jsx)("a",{className:"chatButton",onClick:function(){return e.props.toggleChatMenu()}}),Object(d.jsx)("div",{children:this.props.data}),Object(d.jsx)("a",{className:"hamburgerButton",type:"button",onClick:function(){e.props.toggleHamburgerMenu()},style:this.style})]})}}]),n}(a.a.Component),f=n(90),v=n.n(f),C=n(154),x=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).goToBugReportWebsite=function(){window.location.replace("https://tipsandbugreport.netlify.app/")},e}return Object(l.a)(n,[{key:"logout",value:function(){var e=Object(C.a)(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"delete"},e.next=3,fetch("/logout",t);case 3:return n=e.sent,e.next=6,n.json();case 6:e.sent,window.location.replace("/login");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{className:"HamburgerMenu",style:this.props.style,children:[Object(d.jsx)("a",{className:"exitButton",onClick:function(){return e.props.toggleHamburgerMenu()}}),Object(d.jsxs)("div",{className:"youAreLoggedInAs",children:["Logged in as ",this.props.username," "]}),Object(d.jsx)("button",{onClick:function(){return e.props.toggleSettings()},children:"Settings"}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:function(){return e.logout()},children:"Logout"}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:this.goToBugReportWebsite,children:"Report Bugs"}),Object(d.jsx)("a",{className:"homeLink",href:"/home",children:"Home"})]})}}]),n}(a.a.Component),O=[{name:"select"},{name:"black",bodyColor:"rgb(20, 20, 20)",contrastingBodyColor:"rgb(30, 30, 30)",textColor:"white",yellowColor:"rgb(196, 199, 0)",greenColor:"#52fb9e",lineColor:"white",hamburgerColor:"brightness(100%)"},{name:"gray",bodyColor:"rgb(56, 56, 56)",contrastingBodyColor:"rgb(70,70,70)",textColor:"white",yellowColor:"rgb(238, 241, 35)",greenColor:"#52fb9e",lineColor:"white",hamburgerColor:"brightness(100%)"},{name:"white",bodyColor:"white",contrastingBodyColor:"rgb(200,200,200)",textColor:"rgb(56, 56, 56)",yellowColor:"rgb(196, 199, 0)",greenColor:"#0bdc12",lineColor:"black",hamburgerColor:"brightness(30%)"}],S=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(){return Object(c.a)(this,n),t.call(this)}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=O.map((function(e,t){return Object(d.jsx)("option",{value:t,children:e.name},t)}));return Object(d.jsxs)("div",{className:"Settings",style:this.props.style,children:[Object(d.jsx)("a",{type:"button",onClick:function(){return e.props.toggleSettings()}}),Object(d.jsx)("div",{className:"title",children:"Settings"}),Object(d.jsx)("div",{children:"Theme"}),Object(d.jsx)("select",{value:this.props.theme,onChange:this.props.changeTheme,children:t})]})}}]),n}(a.a.Component),k=(n(449),n(155)),w=n.p+"static/media/ping.6f864733.mp3",M=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).changeCurrentChat=function(t){var n={currentChat:t};window.screen.width<=760&&(n.chatMenuStyle={display:"none"},n.rightContainerStyle={display:"block"}),e.setState(n)},e.toggleHamburgerMenu=function(){e.setState((function(t){var n={display:"block"},s={display:"none"},a="none"===t.hamburgerMenuStyle.display,r={hamburgerMenuStyle:s,rightContainerStyle:n,chatmenuStyle:n};return e.isMobile?a?(r.textUiStyle=s,r.topBarStyle=s,r.chatmenuStyle=s,r.hamburgerMenuStyle=n):(r.chatmenuStyle=s,r.topBarStyle=n,r.textUiStyle=n):a&&(r.hamburgerMenuStyle=n),console.log(r),r}))},e.toggleSettings=function(){e.setState((function(e){var t={display:"none"};return"none"===e.settingsStyle.display&&(t={display:"block"}),{settingsStyle:t,grayBackgroundStyle:t}}))},e.changeTheme=function(t){try{var n=t.target.value;e.socket.emit("settings",{settings:n})}catch(r){n=t}var s=Object.keys(O[n]),a=Object.values(O[n]);e.setState((function(e){return{theme:n}})),s.forEach((function(e,t){document.documentElement.style.setProperty("--".concat(e),a[t])}))},e.toggleChatMenu=function(){e.setState((function(e){var t={chatMenuStyle:{display:"block"},rightContainerStyle:{display:"none"}};return"block"===e.chatMenuStyle.display&&(t={chatMenuStyle:{display:"none"},rightContainerStyle:{display:"block"}}),t}))},e.state={texts:[[{time:3141592653,text:"Loading...",sender:"Loading..."}]],chats:["Loading..."],currentChat:0,username:"Loading",theme:0,hamburgerMenuStyle:{display:"none"},settingsStyle:{display:"none"},internetWarningPopUpStyle:{display:"none"},grayBackgroundStyle:{display:"none"},chatMenuStyle:{display:"block"},rightContainerStyle:{},topBarStyle:{},textUiStyle:{}},e.URL="/",e.righContainer=a.a.createRef(),e.changeCurrentChat=e.changeCurrentChat.bind(Object(u.a)(e)),e.displayMessage=e.displayMessage.bind(Object(u.a)(e)),e.audio=new Audio(w),e.isMobile=window.screen.width<=760,e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.screen.orientation.addEventListener("change",(function(e){0!==window.screen.orientation.angle&&alert("this app works best in portrait mode")})),this.socket=Object(k.io)(this.URL,{withCredentials:!0}),this.socket.on("allTexts",(function(t){"invalid credentials"!==t?(e.setState((function(e){return{chats:t.collections,texts:t.data,username:t.username}})),e.changeTheme(t.settings)):console.log("ERR Credentials Invalid")})),this.socket.on("text",(function(t){e.displayMessage(t),"visible"!==document.visibilityState&&e.audio.play()})),this.socket.on("disconnect",(function(){e.setState((function(e){return{internetWarningPopUpStyle:{display:"block"},grayBackgroundStyle:{display:"block"}}})),window.location.reload()}))}},{key:"displayMessage",value:function(e){var t=this;this.setState((function(n){var s=t.state.currentChat;return e.chat&&(s=n.chats.indexOf(e.chat)),{texts:n.texts.map((function(t,n){var a=t;return n===s&&(a=t.concat([e])),a}))}}))}},{key:"sendAndDisplayMessage",value:function(e){this.displayMessage(e),this.socket.emit("texts",{text:e.text,time:e.time,chat:this.state.chats[this.state.currentChat]})}},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{className:"mainUi",ref:this.righContainer,children:[Object(d.jsx)("div",{className:"internetWarningPopUp",style:this.state.internetWarningPopUpStyle,children:"Connection error, please check your internet"}),Object(d.jsx)("div",{className:"grayBackground",style:this.state.grayBackgroundStyle}),Object(d.jsx)(S,{style:this.state.settingsStyle,toggleSettings:this.toggleSettings,changeTheme:this.changeTheme,theme:this.state.theme}),Object(d.jsx)(b,{changeCurrentChat:function(t){return e.changeCurrentChat(t)},data:this.state.chats,style:this.state.chatMenuStyle,toggleChatMenu:this.toggleChatMenu}),Object(d.jsxs)("div",{className:"rightContainer",style:this.state.rightContainerStyle,children:[Object(d.jsx)(j,{style:this.state.topBarStyle,hamburgerMenuStyle:this.state.hamburgerMenuStyle,data:this.state.chats[this.state.currentChat],toggleHamburgerMenu:this.toggleHamburgerMenu,toggleChatMenu:this.toggleChatMenu}),Object(d.jsx)(x,{username:this.state.username,style:this.state.hamburgerMenuStyle,toggleSettings:this.toggleSettings,toggleHamburgerMenu:this.toggleHamburgerMenu}),Object(d.jsx)(p,{style:this.state.textUiStyle,sendAndDisplayMessage:function(t){return e.sendAndDisplayMessage(t)},data:this.state.texts[this.state.currentChat],username:this.state.username})]})]})}}]),n}(a.a.Component);i.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(M,{})}),document.getElementById("root")),o()}},[[475,1,2]]]);
//# sourceMappingURL=main.f661acf6.chunk.js.map