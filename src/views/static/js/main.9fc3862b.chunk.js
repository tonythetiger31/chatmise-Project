(this["webpackJsonpchatmise-react-frontend"]=this["webpackJsonpchatmise-react-frontend"]||[]).push([[0],{175:function(e,t,n){},176:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(56),i=n.n(c),s=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,177)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},o=n(11),u=n(3),l=n(5),d=n(57);var b=Object(d.io)("/",{withCredentials:!0}),j=n(12),h=n.n(j),m=n(0);function g(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null),a={};function c(){var n=function(){t.current.focus();var n={text:t.current.value,sender:e.username,time:(new Date).getTime()};e.sendAndDisplayMessage(n),t.current.value="",t.current.placeholder="type a message here"};""===t.current.value?t.current.placeholder="that was an empty message :(":h.a.contains(t.current.value,"\\")?alert("please don't use backslashes"):n()}function i(e){var t,n,r;return(e=new Date(e)).getHours()>12?(t="PM",n=e.getHours()-12):(t="AM",0===(n=e.getHours())&&(n=12)),r=e.getMinutes()<=9?"0":"",e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+" "+n+":"+r+e.getMinutes()+" "+t}Object(r.useEffect)((function(){a=e.data,n.current.lastChild.scrollIntoView(),t.current.focus()}),[]),Object(r.useEffect)((function(){e.data!==a&&e.data[0]===a[0]?(console.log("it worked!"),a=e.data,window.screen.width>760?n.current.lastChild.scrollIntoView({behavior:"smooth"}):n.current.lastChild.scrollIntoView()):n.current.lastChild.scrollIntoView()}),[e]);var s=e.data.map((function(t,n){var r=t.sender,a="othersMessage";return t.sender===e.username&&(r="you",a="yourMessage"),Object(m.jsxs)("div",{className:a,children:[Object(m.jsxs)("div",{className:"info",children:[Object(m.jsx)("span",{className:"sender",children:r+" - "}),Object(m.jsx)("span",{className:"time",children:"  "+i(t.time)})]}),t.text]},n)}));return Object(m.jsxs)("div",{className:"TextsUi",children:[Object(m.jsxs)("div",{className:"messagesView",ref:n,children:[s,Object(m.jsx)("div",{})]}),Object(m.jsxs)("div",{className:"messageInputs",children:[Object(m.jsx)("textarea",{onFocus:function(){n.current.lastChild.scrollIntoView()},maxLength:"170",ref:t,onKeyDown:function(e){!function(e){13==e.keyCode&&(c(),e.preventDefault())}(e)},placeholder:"type a message here"}),Object(m.jsx)("button",{onClick:function(){c()},children:"Send"})]})]})}function f(e){var t=e.data.map((function(t,n){return Object(m.jsx)("div",{className:"individualChat",onClick:function(){e.changeCurrentChat(n)},children:t},n)}));return Object(m.jsxs)("div",{className:"ChatMenu",children:[Object(m.jsxs)("div",{className:"topBar",children:[Object(m.jsx)("a",{className:"exitButton",onClick:function(){return e.toggleChatMenu()}}),"Chats"]}),Object(m.jsx)("div",{className:"chats",children:t}),Object(m.jsx)("button",{className:"createChatButton",onClick:function(){return e.toggle("renCreateChat")},children:"+"})]})}var v=n.p+"static/media/exit.05551b1a.svg",O=n.p+"static/media/hamburger.8d514b40.svg";function x(e){var t={content:"url(".concat(O,")")};t=e.renHamburgerMenu?{content:"url(".concat(v,")")}:{content:"url(".concat(O,")")};return Object(m.jsxs)("div",{className:"TopBar",children:[Object(m.jsx)("a",{className:"chatButton",onClick:function(){return e.toggleChatMenu()}}),Object(m.jsx)("div",{children:e.data}),Object(m.jsx)("a",{className:"hamburgerButton",type:"button",onClick:function(){e.toggleHamburgerMenu()},style:t})]})}var C=n(28),p=n.n(C),y=n(58);function I(e){function t(){return(t=Object(y.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"delete"},e.next=3,fetch("/logout",t);case 3:return n=e.sent,e.next=6,n.json();case 6:e.sent,window.location.replace("/login");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var n=e.username===e.admin;return Object(m.jsxs)("div",{className:"HamburgerMenu",children:[Object(m.jsx)("a",{className:"exitButton",onClick:function(){return e.toggleHamburgerMenu()}}),Object(m.jsxs)("div",{className:"youAreLoggedInAs",children:["Logged in as ",e.username," "]}),n&&Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:function(){return e.toggle("renInviteMenu")},children:"Invite"}),Object(m.jsx)("br",{})]}),Object(m.jsx)("button",{onClick:function(){return e.toggle("renChatInfo")},children:"Chat Info"}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{onClick:function(){return e.toggle("renSettings")},children:"Settings"}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{onClick:function(){return e.toggle("renYourInvites")},children:"Your Invites"}),Object(m.jsx)("br",{}),Object(m.jsx)("button",{onClick:function(){return function(){return t.apply(this,arguments)}()},children:"Logout"}),Object(m.jsx)("br",{}),Object(m.jsxs)("div",{className:"links",children:[Object(m.jsx)("a",{href:"/home",children:"Home"}),Object(m.jsx)("pre",{children:" | "}),Object(m.jsx)("a",{href:"https://tipsandbugreport.netlify.app/",children:"Report Bug"})]})]})}var N=[{name:"black",bodyColor:"rgb(20, 20, 20)",contrastingBodyColor:"rgb(30, 30, 30)",textColor:"white",yellowColor:"rgb(196, 199, 0)",greenColor:"#52fb9e",darkGreenColor:"#36a568",greenTextColor:"#36ff90",blueColor:"#45daff",lineColor:"white",hamburgerColor:"brightness(100%)"},{name:"gray",bodyColor:"rgb(56, 56, 56)",contrastingBodyColor:"rgb(70,70,70)",textColor:"white",yellowColor:"rgb(238, 241, 35)",greenColor:"#52fb9e",greenTextColor:"#2de47f",darkGreenColor:"#36a568",blueColor:"rgb(99, 202, 236)",lineColor:"white",hamburgerColor:"brightness(100%)"}];function w(e){var t=N.map((function(e,t){return Object(m.jsx)("option",{value:t,children:e.name},t)}));return Object(m.jsxs)("div",{className:"Settings",style:e.style,children:[Object(m.jsx)("a",{type:"button",onClick:function(){return e.toggle("renSettings")}}),Object(m.jsx)("div",{className:"title",children:"Settings"}),Object(m.jsx)("div",{children:"Theme"}),Object(m.jsx)("select",{value:e.theme,onChange:e.changeTheme,children:t})]})}function M(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null);function a(){var e=t.current.value;h.a.isAlphanumeric(e)?(b.emit("newChat",{chatName:t.current.value}),n.current.innerHTML="creating...",b.on("newChat",(function(e){200===e?(alert("successfully created"),window.location.reload()):400===e||500===e?alert("there was an error when creating your chat"):403===e&&alert("you already have already created the max of 5 chats"),n.current.innerHTML="CREATE"}))):alert("Chat name must be alphanumeric")}return Object(r.useEffect)((function(){t.current.focus()}),[]),Object(m.jsxs)("div",{className:"CreateChat",children:[Object(m.jsx)("a",{type:"button",onClick:function(){return e.toggle("renCreateChat")}}),Object(m.jsx)("div",{className:"title",children:"Create Chat"}),Object(m.jsxs)("form",{onSubmit:function(e){a(),e.preventDefault()},children:[Object(m.jsx)("input",{placeholder:"Chat Name",maxLength:"10",minLength:"4",ref:t,required:!0,size:"15",onKeyDown:function(e){!function(e){32==e.keyCode&&e.preventDefault()}(e)}}),Object(m.jsx)("button",{ref:n,type:"submit",className:"Create",children:"Create"})]})]})}function k(e){var t=e.members.map((function(t,n){return Object(m.jsxs)("div",{className:"members",children:[t===e.username?"You":t," ",Object(m.jsx)("br",{})]},n)})),n=e.username===e.admin;return Object(m.jsxs)("div",{className:"ChatInfo",children:[Object(m.jsx)("a",{type:"button",onClick:function(){return e.toggle("renChatInfo")}}),Object(m.jsx)("div",{className:"title",children:"Chat Info"}),Object(m.jsxs)("div",{className:"subTitle",children:["admin:",Object(m.jsx)("span",{className:"adminInfo",children:n?"You":e.admin})]}),Object(m.jsx)("div",{className:"subTitle",children:"members"}),Object(m.jsx)("div",{className:"info",children:t})]})}function T(e){var t=Object(r.useState)(null),n=Object(l.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(null),s=Object(l.a)(i,2),o=(s[0],s[1]),u=Object(r.useRef)(null),d=Object(r.useRef)(null),j={backgroundColor:"var(--darkGreenColor)",color:"var(--textColor)"},g={backgroundColor:"var(--bodyColor)",color:"var(--textColor)"};function f(){var t=u.current.value,n=h.a.isLength(t,{min:0,max:10})&&h.a.isAlphanumeric(t);o((function(r){return t===r?c({text:"already tried that",color:{}}):t===e.username?c({text:"can't invite yourself",color:{}}):n?(console.log("ran"),b.emit("invite",{chatId:e.chatId,invitee:t}),c({text:"Sending...",color:g}),b.on("invite",(function(e){c(200===e?{text:"Invite Sent!",color:j}:404===e?{text:"user not found",color:{}}:409===e?{text:"user aleady invited",color:{}}:{text:"error",color:{}})}))):c({text:"Must be AlphaNumeric",color:{}}),t}))}return Object(r.useEffect)((function(){u.current.focus()}),[]),Object(m.jsxs)("div",{className:"InviteMenu",children:[Object(m.jsx)("a",{type:"button",onClick:function(){return e.toggle("renInviteMenu")}}),Object(m.jsx)("div",{className:"title",children:"Invite"}),Object(m.jsx)("div",{className:"subTitle",children:"Invite your friends to this chat"}),Object(m.jsxs)("form",{className:"invite",onSubmit:function(e){e.preventDefault(),f()},children:[Object(m.jsx)("input",{ref:u,required:!0,placeholder:"Invite somone",size:"14",maxLength:"10"}),Object(m.jsx)("button",{type:"submit",ref:d,children:"Send"})]}),a&&Object(m.jsx)("div",{className:"message",style:a.color,children:a.text})]})}var S=n(59);function B(e){function t(t,n){b.emit("acceptInvite",{chatId:n,isAccepted:t}),b.on("acceptInvite",(function(r){200!==r?alert("error",r):t?(alert("success"),window.location.reload()):t||e.setAppData((function(e){var t,r=[],a=Object(S.a)(e.invites);try{for(a.s();!(t=a.n()).done;)t.value._id!==n&&r.push()}catch(c){a.e(c)}finally{a.f()}return Object(u.a)(Object(u.a)({},e),{},{invites:r})}))}))}var n=e.invites.map((function(e,n){return console.log(e),Object(m.jsxs)("div",{className:"individualInvite",children:["".concat(e.admin," - ").concat(e.chatName," "),Object(m.jsx)("button",{className:"accept",onClick:function(){return t(!0,e._id)},children:"accept"}),Object(m.jsx)("button",{className:"decline",onClick:function(){return t(!1,e._id)},children:"decline"})]},n)}));return Object(m.jsxs)("div",{className:"YourInvites",children:[Object(m.jsx)("a",{onClick:function(){return e.toggle("renYourInvites")}}),Object(m.jsx)("div",{className:"title",children:"Your Invites"}),0!==n.length?n:Object(m.jsx)("div",{className:"noInvites",children:"you have no invites"})]})}n(175);var H=n.p+"static/media/ping.6f864733.mp3";function L(){var e=Object(r.useState)({texts:[[{time:0,text:"Loading...",sender:"Loading..."}]],chatNames:["Loading..."],chatIds:["Loading..."],username:"Loading",admins:["Loading..."],members:["Loading..."],invites:["Loading..."]}),t=Object(l.a)(e,2),n=t[0],a=t[1],c=function(){var e=window.screen.width<=760&&0===window.screen.orientation.angle,t=Object(r.useState)({renInternetWarning:!1,renChatMenu:!0,renRightContainer:!e,renTobBar:!0,renTextUi:!0,renGrayBackground:!1,renHamburgerMenu:!1,renSettings:!1,renCreateChat:!1,renChatInfo:!1,renInviteMenu:!1,renYourInvites:!1}),n=Object(l.a)(t,2),a=n[0],c=n[1];return[a,c,function(){c((function(t){var n=Object(u.a)(Object(u.a)({},a),{},{renHamburgerMenu:!1,renRightContainer:!0,renChatMenu:!0});return e?t.renHamburgerMenu?(n.renChatMenu=!1,n.renRightContainer=!0,n.renTobBar=!0,n.renTextUi=!0):(n.renTextUi=!1,n.renChatMenu=!1,n.renHamburgerMenu=!0,n.renTobBar=!1):t.renHamburgerMenu||(n.renHamburgerMenu=!0),n}))},function(){c((function(e){return Object(u.a)(Object(u.a)({},a),{},{renChatMenu:!e.renChatMenu,renRightContainer:e.renChatMenu})}))},function(e){c((function(t){var n;return Object(u.a)(Object(u.a)({},a),{},(n={},Object(o.a)(n,e,!t[e]),Object(o.a)(n,"renGrayBackground",!t[e]),n))}))},function(){c((function(e){return Object(u.a)(Object(u.a)({},e),{},{renGrayBackground:!1,renSettings:!1,renCreateChat:!1,renChatInfo:!1,renInviteMenu:!1,renYourInvites:!1})}))}]}(),i=Object(l.a)(c,6),s=i[0],d=i[1],j=i[2],h=i[3],v=i[4],O=i[5],C=Object(r.useState)(0),p=Object(l.a)(C,2),y=p[0],S=p[1],L=Object(r.useState)(1),R=Object(l.a)(L,2),A=R[0],D=R[1],E=new Audio(H);Object(r.useEffect)((function(){window.screen.orientation.addEventListener("change",(function(e){0!==window.screen.orientation.angle&&alert("this app works best in portrait mode")})),b.on("allTexts",(function(e){"invalid credentials"!==e?(a(e),G(e.settings)):console.log("ERR Credentials Invalid")})),b.on("texts",(function(e){Y(e),"visible"!==document.visibilityState&&E.play()})),b.on("disconnect",(function(){d(Object(u.a)(Object(u.a)({},s),{},{renInternetWarning:!0,renGrayBackground:!0})),window.location.reload()}))}),[]);function Y(e){a((function(t){var n=y;e.chatId&&(n=t.chatIds.indexOf(e.chatId)),console.log({chatToAddTo:n,message:e});var r=t.texts.map((function(t,r){var a=t;return r===n&&(a=t.concat([e])),a}));return console.log({newTexts:r},t.texts),Object(u.a)(Object(u.a)({},t),{},{texts:r})}))}var G=function(e){try{var t=e.target.value;b.emit("settings",{settings:t})}catch(a){t=e}var n=Object.keys(N[t]),r=Object.values(N[t]);D(t),n.forEach((function(e,t){document.documentElement.style.setProperty("--".concat(e),r[t])}))};return Object(m.jsxs)("div",{className:"mainUi",children:[s.renInternetWarning&&Object(m.jsx)("div",{className:"internetWarningPopUp",children:"Connection error, please check your internet"}),s.renGrayBackground&&Object(m.jsx)("div",{className:"grayBackground",onClick:function(){return O()}}),s.renSettings&&Object(m.jsx)(w,{toggle:v,changeTheme:G,theme:A}),s.renChatInfo&&Object(m.jsx)(k,{toggle:v,admin:n.admins[y],members:n.members[y],username:n.username}),s.renCreateChat&&Object(m.jsx)(M,{toggle:v}),s.renInviteMenu&&Object(m.jsx)(T,Object(o.a)({toggle:v,chatId:n.chatIds[y],username:n.username,chatName:n.chatNames[y]},"username",n.username)),s.renChatMenu&&Object(m.jsx)(f,{changeCurrentChat:function(e){return function(e){window.screen.width<=760&&d(Object(u.a)(Object(u.a)({},s),{},{renChatMenu:!1,renRightContainer:!0})),S(e)}(e)},data:n.chatNames,toggleChatMenu:h,toggle:v}),s.renYourInvites&&Object(m.jsx)(B,{toggle:v,invites:n.invites,setAppData:a}),s.renRightContainer&&Object(m.jsxs)("div",{className:"rightContainer",children:[s.renTobBar&&Object(m.jsx)(x,{renHamburgerMenu:s.renHamburgerMenu,data:n.chatNames[y],toggleHamburgerMenu:j,toggleChatMenu:h}),s.renHamburgerMenu&&Object(m.jsx)(I,{username:n.username,admin:n.admins[y],toggle:v,toggleHamburgerMenu:j}),s.renTextUi&&Object(m.jsx)(g,{sendAndDisplayMessage:function(e){return Y(t=e),void b.emit("texts",{text:t.text,time:t.time,chatId:n.chatIds[y]});var t},data:n.texts[y],username:n.username})]})]})}i.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(L,{})}),document.getElementById("root")),s()}},[[176,1,2]]]);
//# sourceMappingURL=main.9fc3862b.chunk.js.map